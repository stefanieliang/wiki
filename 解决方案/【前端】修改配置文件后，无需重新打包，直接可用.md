# 【前端】修改配置文件后，无需重新打包，直接可用

在实际的工作应用场景中，像是测试环境、生产环境的`ip`地址，获取第三方应用token的公钥入参`pubkey`这些直接写在前端工程里的配置文件，可能会在打包后出现更改的情况，这样的话，就不能直接将配置文件直接通过`import`的方式引用到代码里。基于此种情况，我们提供了如下几种优化方案。

## 先看一下不做任何处理的效果

在public文件夹下创建`properties.ts`文件。（public文件夹下面的文件可以不做编译，直接输出）

```typescript
export const client_secret = "d5d75a9166264d11a2f1";
```

使用时，在`main.ts`中通过`import`引入

```typescript
import { client_secret } from "../public/properties";
```

编译后发现，虽然`public` 目录下的`properties.ts`文件没有被编译，但是引用中的`client_secret` 这个变量的值被压缩到了`dist\assets\index-09f1bae2.js`中。这种方式，一旦出现需要修改配置文件的情况，要么需要重新编译，要么就需要手动修改`js`中的变量，是很不友好的。

![image-20230307152232556](imgs\image-20230307152232556.png)



## 优化方案

【思路】通过引入全局变量解决。

在public文件夹下创建`properties.js`文件。（public文件夹下面的文件可以不做编译，直接输出）

```javascript
window.thirdAppConfig = {
    client_secret : "d5d75a9166264d11a2f1"
}
```

在`index.html`中通过`script`注入成全局变量

```html
<head>
	...
	<script src="/properties.js"></script>
	...
</head>
```

使用时，在`main.ts`中引入全局变量

```javascript
declare const thirdAppConfig:any;
const client_secret = thirdAppConfig.client_secret;
```

编译后发现，只生成了一个`properties.js`文件。

![image-20230307154217449](imgs\image-20230307154217449.png)

搜索`client_secret`发现，在真正使用变量的文件`dist\assets\index-8bd75f69.js`中，出现的是该变量的key而不是value。因此，在配置文件发生变化后，我们可以只替换`properties.js`文件即可。

![image-20230307154729526](imgs\image-20230307154729526.png)

